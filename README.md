# company-database
CREATE DATABASE COMPANY;
USE COMPANY;
CREATE TABLE DEPARTMENT
(DNO VARCHAR(20) PRIMARY KEY,
DNAME VARCHAR(20),
MGR_SSN VARCHAR(20),
MGR_START_DATE DATE);
DESC DEPARTMENT;
CREATE TABLE EMPLOYEE
(SSN VARCHAR(20) PRIMARY KEY,
NAME VARCHAR(20),
ADDRESS VARCHAR(20),
SEX CHAR(1),
SALARY INT,
SUPERSSN VARCHAR(20),
DNO VARCHAR(20),
FOREIGN KEY (SUPERSSN) REFERENCES EMPLOYEE (SSN),
FOREIGN KEY (DNO) REFERENCES DEPARTMENT (DNO));
DESC EMPLOYEE;
ALTER TABLE DEPARTMENT
ADD FOREIGN KEY (MGR_SSN) REFERENCES EMPLOYEE(SSN);
CREATE TABLE DLOCATION
(DLOC VARCHAR(20),
DNO VARCHAR(20),
FOREIGN KEY (DNO) REFERENCES DEPARTMENT(DNO),
PRIMARY KEY (DNO, DLOC));
DESC DLOCATION;
CREATE TABLE PROJECT
(PNO INT PRIMARY KEY,
PNAME VARCHAR(20),
PLOCATION VARCHAR(20),
DNO VARCHAR(20),
FOREIGN KEY (DNO) REFERENCES DEPARTMENT(DNO));
DESC PROJECT;


CREATE TABLE WORKS_ON
(HOURS INT,
SSN VARCHAR(20),
PNO INT,
FOREIGN KEY (SSN) REFERENCES EMPLOYEE(SSN),
FOREIGN KEY (PNO) REFERENCES PROJECT(PNO),
PRIMARY KEY (SSN, PNO));
DESC WORKS_ON;
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR01','KARTHIK','BANGALORE','M', 450000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR02','ESTHER PICARDO','MANGALORE','F', 500000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR03','DANISH','MYSORE','M', 700000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR04','ANUPAMA','KANNUR','F', 500000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR05','BEN SCOTT','BANGALORE','M', 650000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR06','SOUPARNIKA','KOLLUR','F', 450000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR07','ABHIK','KOLKATA','M', 800000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR08','RAJINIKANTH','CHENNAI','M', 350000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR09','AADYA','MANGALORE','F', 300000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR10','ARJUN','HYDERABAD','M', 650000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR11','ALOYSIUS DSOUZA','MANGALORE','M', 800000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR12','BHAVANA','BANGALORE','F', 750000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR13','APOORVA','TEXAS','F', 900000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR14','TEJASWINI','MANGALORE','F', 600000);
INSERT INTO EMPLOYEE (SSN, NAME, ADDRESS, SEX, SALARY) VALUES
('AR15','AYUSH','HYDERABAD','M', 660000);
SELECT * FROM EMPLOYEE;
INSERT INTO DEPARTMENT VALUES ('1','HEADQUARTERS','AR09', '2015-01-02');
INSERT INTO DEPARTMENT VALUES ('2','RESEARCH','AR07', '2017-02-04');
INSERT INTO DEPARTMENT VALUES ('3','ADMINISTRATION','AR01', '2016-04-05');
INSERT INTO DEPARTMENT VALUES ('4','ACCOUNTS', 'AR10', '2017-06-06');
INSERT INTO DEPARTMENT VALUES ('5','SALES','AR05', '2018-01-08');
SELECT * FROM DEPARTMENT;


UPDATE EMPLOYEE SET DNO='2', SUPERSSN='AR07' WHERE SSN='AR01';
UPDATE EMPLOYEE SET DNO='5', SUPERSSN='AR10' WHERE SSN='AR02';
UPDATE EMPLOYEE SET DNO='2', SUPERSSN='AR09' WHERE SSN='AR03';
UPDATE EMPLOYEE SET DNO='1', SUPERSSN='AR09' WHERE SSN='AR04';
UPDATE EMPLOYEE SET DNO='2', SUPERSSN='AR07' WHERE SSN='AR05';
UPDATE EMPLOYEE SET DNO='3', SUPERSSN='AR10' WHERE SSN='AR06';
UPDATE EMPLOYEE SET DNO='2', SUPERSSN= NULL WHERE SSN='AR07';
UPDATE EMPLOYEE SET DNO='3', SUPERSSN='AR07' WHERE SSN='AR08';
UPDATE EMPLOYEE SET DNO='2', SUPERSSN='AR10' WHERE SSN='AR09';
UPDATE EMPLOYEE SET DNO='3', SUPERSSN= NULL WHERE SSN='AR10';
UPDATE EMPLOYEE SET DNO='2', SUPERSSN='AR09' WHERE SSN='AR11';
UPDATE EMPLOYEE SET DNO='3', SUPERSSN='AR02' WHERE SSN='AR12';
UPDATE EMPLOYEE SET DNO='3', SUPERSSN='AR03' WHERE SSN='AR13';
UPDATE EMPLOYEE SET DNO='3', SUPERSSN='AR07' WHERE SSN='AR14';
UPDATE EMPLOYEE SET DNO='4', SUPERSSN='AR10' WHERE SSN='AR15';
SELECT * FROM EMPLOYEE;
INSERT INTO DLOCATION VALUES ('KOCHI', '1');
INSERT INTO DLOCATION VALUES ('MANGALORE ', '2');
INSERT INTO DLOCATION VALUES ('BANGALORE', '3');
INSERT INTO DLOCATION VALUES ('MYSORE', '4');
INSERT INTO DLOCATION VALUES ('DELHI', '5');
SELECT * FROM DLOCATION;
INSERT INTO PROJECT VALUES (1000,'IOT','BANGALORE','5');
INSERT INTO PROJECT VALUES (1001,'CLOUD','CHENNAI','2');
INSERT INTO PROJECT VALUES (1002,'BIGDATA','BANGALORE','5');
INSERT INTO PROJECT VALUES (1003,'INSAT','DELHI','3');
INSERT INTO PROJECT VALUES (1004,'GAN','KOCHI','1');
INSERT INTO PROJECT VALUES (1005,'WSN','MANGALORE','1');
INSERT INTO PROJECT VALUES (1006,'WAR FIELD SPYING','TEXAS','4');
SELECT * FROM PROJECT;
INSERT INTO WORKS_ON VALUES (12,'AR02', 1000);
INSERT INTO WORKS_ON VALUES (6, 'AR01', 1001);
INSERT INTO WORKS_ON VALUES (9, 'AR02', 1002);
INSERT INTO WORKS_ON VALUES (10,'AR03', 1005);
INSERT INTO WORKS_ON VALUES (3, 'AR05', 1000);
INSERT INTO WORKS_ON VALUES (4, 'AR06', 1001);
INSERT INTO WORKS_ON VALUES (15,'AR07', 1002);
INSERT INTO WORKS_ON VALUES (6, 'AR04', 1006);
INSERT INTO WORKS_ON VALUES (7, 'AR01', 1003);
INSERT INTO WORKS_ON VALUES (5, 'AR08', 1004);
INSERT INTO WORKS_ON VALUES (16,'AR09', 1005);
INSERT INTO WORKS_ON VALUES (4, 'AR11', 1006);
INSERT INTO WORKS_ON VALUES (10,'AR05', 1006);
INSERT INTO WORKS_ON VALUES (7, 'AR13', 1000);


INSERT INTO WORKS_ON VALUES (6, 'AR10', 1006);
INSERT INTO WORKS_ON VALUES (5, 'AR07', 1000);
SELECT * FROM WORKS_ON;

/*1. Make a list of all project numbers for projects that involve an
employee whose last name is ‘Scott’, either as a worker or as a
manager of the department that controls the project.*/
(SELECT PNO
FROM PROJECT P, DEPARTMENT D, EMPLOYEE E
WHERE P.DNO=D.DNO AND D.MGR_SSN=E.SSN AND E.NAME LIKE '%SCOTT')
UNION
(SELECT PNO
FROM WORKS_ON W, EMPLOYEE E
WHERE W.SSN=E.SSN AND E.NAME LIKE '%SCOTT');
/*2. Show the resulting salaries if every employee working on the
‘IoT’ project is given a 10 percent raise.*/
SELECT E.NAME, E.SALARY, 1.1*E.SALARY INCR_SALARY
FROM EMPLOYEE E, PROJECT P, WORKS_ON W
WHERE E.SSN=W.SSN AND P.PNO=W.PNO AND P.PNAME='IOT';
/*3. Find the sum of the salaries of all employees of the ‘Accounts’
department, as well as the maximum salary, the minimum salary, and
the average salary in this department.*/
SELECT DNAME, SUM(SALARY) TOTAL_SALARY, MAX(SALARY) MAX_SALARY,
MIN(SALARY) MIN_SALARY, AVG(SALARY) AVG_SALARY
FROM EMPLOYEE NATURAL JOIN DEPARTMENT
WHERE DNAME='ACCOUNTS';
/*4. Retrieve the name of each employee who works on all the
projects controlled by department number 5
(use NOT EXISTS operator).*/
SELECT E.NAME
FROM EMPLOYEE E
WHERE NOT EXISTS (SELECT P.PNO
FROM PROJECT P
WHERE P.DNO=5 AND
P.PNO NOT IN (SELECT W.PNO
FROM WORKS_ON W
WHERE E.SSN=W.SSN));


/*5. For each department that has more than five employees, retrieve
the department number and the number of its employees who are making
more than Rs. 6,00,000.*/
SELECT DNO, COUNT(*) COUNT
FROM EMPLOYEE
WHERE
DNO IN (SELECT DNO
FROM EMPLOYEE
GROUP BY DNO
HAVING COUNT(*)>5)
AND SALARY>600000
GROUP BY DNO;
